<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mayatech Hızlı Dosya Sistemi</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f6f5f4;
            --window-bg: #ffffff;
            --sidebar-bg: #e9e8e7;
            --text-primary: #2e3436;
            --text-secondary: #5c6163;
            --accent-color: #3584e4;
            --border-color: #d3d7cf;
        }
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: var(--text-primary);
        }

        /* --- Login Ekranı --- */
        .login-overlay {
            position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px); display: flex; justify-content: center;
            align-items: center; z-index: 100; transition: opacity 0.3s ease;
        }
        .login-box {
            background: var(--window-bg); padding: 30px 40px; border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2); text-align: center;
        }
        .login-box h2 { margin-top: 0; font-size: 1.4em; }
        input[type="password"] {
            width: 250px; padding: 12px; border: 1px solid var(--border-color);
            border-radius: 6px; font-size: 1em; margin-top: 10px;
        }
        .login-button {
            background-color: var(--accent-color); color: white; border: none; padding: 12px 24px;
            border-radius: 6px; font-size: 1em; font-weight: 500; cursor: pointer;
            margin-top: 20px; transition: background-color 0.2s;
        }
        .login-button:hover { background-color: #2a6ec4; }
        .error-message { color: #cc0000; display: none; margin-top: 15px; font-weight: 500; }

        /* --- File Manager UI --- */
        .file-manager-window {
            width: 100%; height: 100%; max-width: 960px; max-height: 700px;
            background-color: var(--window-bg); border: 1px solid var(--border-color);
            border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: none; flex-direction: column; overflow: hidden;
        }
        .fm-header {
            display: flex; align-items: center; padding: 8px;
            background-color: #e0e0e0; border-bottom: 1px solid var(--border-color);
        }
        .header-controls { flex-grow: 1; display: flex; align-items: center; }
        .breadcrumb { font-weight: 600; margin-left: 10px; }
        .header-actions { display: flex; gap: 10px; }
        .fm-body { display: flex; flex-grow: 1; overflow: hidden; }
        .fm-sidebar {
            width: 220px; background-color: var(--sidebar-bg);
            padding: 15px; border-right: 1px solid var(--border-color);
            flex-shrink: 0; overflow-y: auto;
        }
        .sidebar-list { list-style: none; padding: 0; margin: 0; }
        .sidebar-item a {
            display: flex; align-items: center; padding: 10px;
            border-radius: 6px; text-decoration: none; color: var(--text-primary);
            font-weight: 500; font-size: 0.95em;
        }
        .sidebar-item a.active { background-color: #c9ced4; font-weight: 600; }
        .sidebar-icon { margin-right: 12px; fill: var(--text-secondary); width: 20px; height: 20px; }
        .active .sidebar-icon { fill: var(--accent-color); }
        .fm-main-content { flex-grow: 1; overflow-y: auto; padding: 20px; }
        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 20px;
        }
        .file-item {
            display: flex; flex-direction: column; align-items: center;
            text-align: center; cursor: pointer; padding: 10px; border-radius: 6px;
        }
        .file-item:hover { background-color: #dbe9f9; }
        .file-icon-wrapper { position: relative; }
        .file-icon { width: 80px; height: 80px; fill: var(--accent-color); }
        .file-type-overlay {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -45%);
            font-size: 2.5em; opacity: 0.6;
        }
        .file-name {
            font-weight: 500; margin-top: 8px; word-break: break-word;
            font-size: 0.9em;
        }
        .edit-button {
            background-color: var(--accent-color); color: white; border: none;
            padding: 4px 10px; border-radius: 99px; font-size: 0.8em;
            margin-top: 8px; opacity: 0; transition: opacity 0.2s;
        }
        .file-item:hover .edit-button { opacity: 1; }

        /* --- Mobile Responsive --- */
        @media (max-width: 768px) {
            .file-manager-window { border-radius: 0; max-height: 100vh; height: 100vh; }
            .fm-sidebar {
                position: absolute; top: 45px; left: 0; bottom: 0; z-index: 20;
                transform: translateX(-100%); transition: transform 0.3s ease;
                background: #f0f0f0; width: 250px;
            }
            .fm-sidebar.open { transform: translateX(0); }
            .fm-header { padding: 4px 8px; }
            .file-grid { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
            .menu-toggle { display: block !important; }
        }
    </style>
</head>
<body>

    <div class="login-overlay" id="login-screen">
        <div class="login-box">
            <h2>Mayatech Hızlı Dosya Sistemi</h2>
            <input type="password" id="password" placeholder="Parola">
            <button class="login-button" id="login-button">Giriş Yap</button>
            <p class="error-message" id="login-error-message">Hatalı parola.</p>
        </div>
    </div>

    <main class="file-manager-window" id="main-screen">
        <header class="fm-header">
            <div class="header-controls">
                <svg class="menu-toggle" id="menu-toggle" style="display: none; cursor: pointer;" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 6H20M4 12H20M4 18H20" stroke="#2e3436" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <div class="breadcrumb">
                    <svg viewBox="0 0 16 16" width="16" height="16" fill="currentColor"><path d="M6.5 14.5v-3.5h3v3.5a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.25-.433L8.25 6.317a.5.5 0 0 0-.5 0L3.75 9.067A.5.5 0 0 0 3.5 9.5v5a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5Z M15 8.25a.75.75 0 0 0-1.5 0v5.5a.75.75 0 0 1-.75.75H10V9.5a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v5H3.75A.75.75 0 0 1 3 13.75V8.25a.75.75 0 0 0-1.5 0v5.5A2.25 2.25 0 0 0 3.75 16h8.5A2.25 2.25 0 0 0 14.5 13.75V8.25Z M8 1.25a.75.75 0 0 0-.75.75v1.25H6.227a.25.25 0 0 0-.177.427l2.25 2.25a.25.25 0 0 0 .354 0l2.25-2.25a.25.25 0 0 0-.177-.427H8.75V2a.75.75 0 0 0-.75-.75Z"/></svg>
                    <span>Home</span>
                </div>
            </div>
        </header>
        <div class="fm-body">
            <aside class="fm-sidebar" id="sidebar">
                <ul class="sidebar-list">
                    <li class="sidebar-item"><a href="#" class="active"><svg class="sidebar-icon" viewBox="0 0 16 16"><use href="#icon-home"/></svg><span>Home</span></a></li>
                    <li class="sidebar-item"><a href="#"><svg class="sidebar-icon" viewBox="0 0 16 16"><use href="#icon-documents"/></svg><span>Documents</span></a></li>
                    <li class="sidebar-item"><a href="#"><svg class="sidebar-icon" viewBox="0 0 16 16"><use href="#icon-downloads"/></svg><span>Downloads</span></a></li>
                    <li class="sidebar-item"><a href="#"><svg class="sidebar-icon" viewBox="0 0 16 16"><use href="#icon-trash"/></svg><span>Trash</span></a></li>
                </ul>
            </aside>
            <section class="fm-main-content">
                <div class="file-grid" id="file-list"></div>
            </section>
        </div>
    </main>
    
    <svg width="0" height="0" style="display: none;">
        <defs>
            <symbol id="icon-folder" viewBox="0 0 80 80">
                <path d="M32,13.333V9.333c0-2.211,1.789-4,4-4h21.333c2.211,0,4,1.789,4,4v4H32z" fill="#729fcf"/>
                <path d="M68,20H12c-2.211,0-4,1.789-4,4v42.667c0,2.211,1.789,4,4,4h56c2.211,0,4-1.789,4-4V24 C72,21.789,70.211,20,68,20z" fill="#729fcf"/>
            </symbol>
            <symbol id="icon-home" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.75 15.25a.75.75 0 0 1-.75-.75V8.835l4.52-3.39a.75.75 0 0 1 .96 0l4.52 3.39v5.665a.75.75 0 0 1-.75.75H3.75Zm.75-8.939L8 3.511l3.5 2.799v5.19H4.5v-5.19Z"/></symbol>
            <symbol id="icon-documents" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.75 1.75a2.25 2.25 0 0 0-2.25 2.25v9.5c0 1.24 1.01 2.25 2.25 2.25h8.5A2.25 2.25 0 0 0 14.5 13.5V6.625a2.25 2.25 0 0 0-.66-1.591L11.465 2.66A2.25 2.25 0 0 0 9.875 2h-6.125a.25.25 0 0 0-.25.25v1.5a.25.25 0 0 0 .25.25h6.125a.75.75 0 0 1 .53.22l2.375 2.375a.75.75 0 0 1 .22.53v6.875a.75.75 0 0 1-.75.75h-8.5a.75.75 0 0 1-.75-.75v-9.5a.75.75 0 0 1 .75-.75H9.5a.25.25 0 0 0 .25-.25v-1.5a.25.25 0 0 0-.25-.25H3.75Z"/></symbol>
            <symbol id="icon-downloads" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.625 1.75a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V3.31L1.97 5.215a.75.75 0 0 1-1.06-1.061l3.5-3.5a.75.75 0 0 1 1.06 0l3.5 3.5a.75.75 0 1 1-1.06 1.06L5.375 3.31v4.69a.75.75 0 0 1-1.5 0v-5.5a.75.75 0 0 1 .75-.75ZM3.75 11a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 3.75 11ZM5.25 11.75a.75.75 0 0 0-1.5 0v1.5a.75.75 0 0 0 1.5 0v-1.5Z M14.25 13a.75.75 0 0 0-1.5 0v1.5a.75.75 0 0 0 1.5 0v-1.5ZM6.75 11a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 6.75 11ZM8.25 11.75a.75.75 0 0 0-1.5 0v1.5a.75.75 0 0 0 1.5 0v-1.5ZM9.75 11a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 9.75 11ZM11.25 11.75a.75.75 0 0 0-1.5 0v1.5a.75.75 0 0 0 1.5 0v-1.5Z M12.75 11a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5a.75.75 0 0 1 .75-.75Z"/></symbol>
            <symbol id="icon-trash" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.75 4.75a.75.75 0 0 0 0 1.5h.5v6.5a1.5 1.5 0 0 0 1.5 1.5h4.5a1.5 1.5 0 0 0 1.5-1.5v-6.5h.5a.75.75 0 0 0 0-1.5h-8.5ZM5.5 6.25v6.5h-1.5V6.25h1.5Zm2.5 0v6.5h-1v-6.5h1Zm2.5 0v6.5h-1v-6.5h1Z M12 3.25a.75.75 0 0 0-.75-.75H4.75a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 .75-.75Z"/></symbol>
        </defs>
    </svg>

    <script>
        const loginScreen = document.getElementById('login-screen');
        const mainScreen = document.getElementById('main-screen');
        const passwordInput = document.getElementById('password');
        const loginButton = document.getElementById('login-button');
        const loginErrorMessage = document.getElementById('login-error-message');
        const fileList = document.getElementById('file-list');
        const menuToggle = document.getElementById('menu-toggle');
        const sidebar = document.getElementById('sidebar');

        function displayFiles(files) {
            fileList.innerHTML = '';
            files.forEach(file => {
                const isSheet = file.name.includes('.xls') || file.name.includes('Listesi');
                const fileTypeIcon = isSheet ? '📊' : '📄';
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div class="file-icon-wrapper">
                        <svg class="file-icon" viewBox="0 0 80 80"><use href="#icon-folder"/></svg>
                        <span class="file-type-overlay">${fileTypeIcon}</span>
                    </div>
                    <span class="file-name">${file.name}</span>
                    <a href="${file.url}" target="_blank" style="text-decoration: none;">
                        <button class="edit-button">Düzenle</button>
                    </a>
                `;
                fileList.appendChild(fileItem);
            });
        }
        
        async function handleLogin() {
            const password = passwordInput.value;
            if (!password) { loginErrorMessage.style.display = 'block'; return; }
            loginButton.disabled = true;
            loginButton.textContent = 'Doğrulanıyor...';
            loginErrorMessage.style.display = 'none';

            try {
                const response = await fetch('/api/getFiles', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ password: password }) });
                if (response.ok) {
                    const files = await response.json();
                    displayFiles(files);
                    loginScreen.style.opacity = '0';
                    setTimeout(() => {
                        loginScreen.style.display = 'none';
                        mainScreen.style.display = 'flex';
                    }, 300);
                } else {
                    loginErrorMessage.style.display = 'block'; passwordInput.value = '';
                }
            } catch (error) {
                loginErrorMessage.textContent = 'Bir ağ hatası oluştu.'; loginErrorMessage.style.display = 'block';
            } finally {
                loginButton.disabled = false; loginButton.textContent = 'Giriş Yap';
            }
        }
        loginButton.addEventListener('click', handleLogin);
        passwordInput.addEventListener('keyup', (event) => { if (event.key === 'Enter') { handleLogin(); } });
        
        // Mobile sidebar toggle
        if (menuToggle) {
             menuToggle.addEventListener('click', () => sidebar.classList.toggle('open'));
        }
    </script>
</body>
</html>

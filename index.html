<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mayatech Hƒ±zlƒ± Form Sistemi</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');
        body { font-family: 'Inter', sans-serif; margin: 0; background-color: #f9fafb; color: #1f2937; }
        .login-container { display: flex; justify-content: center; align-items: center; height: 100vh; }
        .login-box { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 360px; text-align: center; }
        .login-box h2 { margin-top: 0; font-size: 1.5em; }
        .login-box p { color: #6b7280; margin-bottom: 24px; }
        input[type="password"] { width: 90%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1em; }
        button { background-color: #0d9488; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-size: 1em; font-weight: 500; cursor: pointer; margin-top: 20px; transition: background-color 0.2s; width: 100%; }
        button:hover { background-color: #0f766e; }
        #error-message { color: #ef4444; display: none; margin-top: 15px; }

        .explorer-layout { display: flex; height: 100vh; background-color: white; }
        .nav-pane { width: 280px; background: #f9fafb; border-right: 1px solid #e5e7eb; padding: 20px; }
        .nav-header { font-size: 0.9em; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 12px; }
        .nav-list a { display: flex; align-items: center; padding: 10px; border-radius: 6px; text-decoration: none; color: #1f2937; font-weight: 500; }
        .nav-list a.active { background-color: #e5e7eb; }
        .nav-list .icon { margin-right: 12px; font-size: 1.2em; }
        
        .main-pane { flex-grow: 1; display: flex; flex-direction: column; }
        .main-header { padding: 16px 24px; border-bottom: 1px solid #e5e7eb; font-weight: 600; font-size: 1.2em; }
        .file-browser { flex-grow: 1; padding: 24px; overflow-y: auto; }
        .file-item { display: flex; align-items: center; padding: 12px; border-bottom: 1px solid #f3f4f6; }
        .file-item:hover { background-color: #f3f4f6; border-radius: 8px; }
        .file-item .icon { margin-right: 16px; font-size: 1.5em; }
        .file-item .name { flex-grow: 1; font-weight: 500; }
        .edit-button { background: #e0f2fe; color: #0ea5e9; border: none; padding: 8px 16px; font-weight: 500; width: auto; margin: 0; }
        .edit-button:hover { background-color: #bae6fd; }
    </style>
</head>
<body>
    <div id="app-container">
        <div class="login-container" id="login-screen">
            <div class="login-box">
                <h2>Mayatech Hƒ±zlƒ± Form Sistemi</h2>
                <p>Devam etmek i√ßin l√ºtfen parolanƒ±zƒ± girin.</p>
                <input type="password" id="password" placeholder="Parola">
                <button id="login-button">Giri≈ü Yap</button>
                <p id="error-message">Hatalƒ± veya eksik parola girdiniz.</p>
            </div>
        </div>

        <div class="explorer-layout" id="main-screen" style="display: none;">
            <aside class="nav-pane">
                <div class="nav-header">Formlar</div>
                <div class="nav-list">
                    <a href="#" class="active"><span class="icon">üìÅ</span> T√ºm Dosyalar</a>
                </div>
            </aside>
            <main class="main-pane">
                <header class="main-header">T√ºm Dosyalar</header>
                <div class="file-browser" id="file-list"></div>
            </main>
        </div>
    </div>
    <script>
        const loginScreen = document.getElementById('login-screen');
        const mainScreen = document.getElementById('main-screen');
        const passwordInput = document.getElementById('password');
        const loginButton = document.getElementById('login-button');
        const errorMessage = document.getElementById('error-message');
        const fileList = document.getElementById('file-list');

        function displayFiles(files) {
            fileList.innerHTML = '';
            files.forEach(file => {
                const fileType = file.name.includes('.xls') ? 'üìä' : 'üìÑ';
                const fileDiv = document.createElement('div');
                fileDiv.className = 'file-item';
                fileDiv.innerHTML = `
                    <span class="icon">${fileType}</span>
                    <span class="name">${file.name}</span>
                    <a href="${file.url}" target="_blank"><button class="edit-button">D√ºzenle</button></a>
                `;
                fileList.appendChild(fileDiv);
            });
        }
        
        // --- √ñNCEKƒ∞ KODDAN KOPYALANAN ƒ∞LETƒ∞≈ûƒ∞M FONKSƒ∞YONU ---
        async function handleLogin() {
            const password = passwordInput.value;
            if (!password) { errorMessage.style.display = 'block'; return; }
            loginButton.disabled = true;
            loginButton.textContent = 'Doƒürulanƒ±yor...';
            try {
                const response = await fetch('/api/getFiles', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ password: password }) });
                if (response.ok) {
                    const files = await response.json();
                    displayFiles(files);
                    loginScreen.style.display = 'none';
                    mainScreen.style.display = 'flex';
                } else {
                    errorMessage.style.display = 'block'; passwordInput.value = '';
                }
            } catch (error) {
                errorMessage.textContent = 'Bir aƒü hatasƒ± olu≈ütu. L√ºtfen tekrar deneyin.'; errorMessage.style.display = 'block';
            } finally {
                loginButton.disabled = false; loginButton.textContent = 'Giri≈ü Yap';
            }
        }
        loginButton.addEventListener('click', handleLogin);
        passwordInput.addEventListener('keyup', (event) => { if (event.key === 'Enter') { handleLogin(); } });
    </script>
</body>
</html>
